## devops深度理解

第一，公司发展到BAT这种体量，会招很多人，JAVA，PHP，GO 技术栈都会有，需要协调技术栈；第二，项目到后期往往会变得很大，全部都兑到一个项目里，最直接的后果就是项目变得很大，上线项目启动时间变长，一个BUG可能导致整个业务全线崩溃，最终的后果就是项目变得越来越难以维护，加一个改一个东西几乎搞不动，而且还越来越难重构，牵一发而动全身。

所以，`拆分解耦是最终的出路，将项目拆成一个个小的服务单独部署`，以电商项目为例如图，将整个项目拆分为用户服务，商品服务，订单服务，积分服务......每个服务单独部署，之间通过互相调用的方式来交互，而且可以将一些基础服务例如上传图片，发送短信等很多服务都需要的基础东西，抽象到一个单独的服务，也就是前些年鼓吹的很厉害的‘中台服务’。

`拆分部署催生出DEVOPS` 再看看这种架构下的开发模式DEVOPS，运维需要做的上线工作，主要就是将代码部署到对应的机器里面，微服务有那么多的服务，每个大点的公司几百个服务不算多，而且还可能随时搞一个服务出来，如果还按照原始的脚本部署方式，可能最后连是哪个脚本都找不到。而且，如果每个服务上线都需要运维来同意，开发也太卑微了，估计要天天求着运维同意发布，运维也会烦不胜烦。

那么为何不能再远程部署一些机器，专门用来管理代码，进行上线工作，由运维事先把上线的规则都给定义好了，开发只要按照他的规则都访问这台服务器进行各自的代码合成和发布，自己上线呢，能用代码自动完成的事情就绝不要手动解决，这是每个开发人员都在想的东西。`运维需要做的事情，慢慢的都沉淀到了各个平台上面`，例如监控，有专门的监控组件和可视化，基础服务例如服务器，CDN，负载均衡等基础服务可以外包到云服务厂商，日志也有专门的日志工具，链路追踪也有专门的组件和可视化，还有网关等，渐渐的，只要这些都配置好了，开发也可以做运维的部分工作，毕竟开发才是最了解代码的人，哪里出了问题看看监控日志，可以最快速度定位到问题，于是DEVOPS开发模式诞生了，开发也是运维。

我们知道，一个软件从零开始到最终交付，大概包括以下几个阶段：**产品规划、开发编码、构建、QA测试、发布、部署和维护。**

最初大家说到DEVOPS，都是指的‘开发运维一体化’

### devops平台搭建工具

`项目管理（PM）`：jira。运营可以上去提问题，可以看到各个问题的完整的工作流，待解决未解决等；

`代码管理`：gitlab。jenkins或者K8S都可以集成gitlab，进行代码管理，上线，回滚等；

`持续集成CI（Continuous Integration）`：gitlab ci。开发人员提交了新代码之后，立刻进行构建、（单元）测试。根据测试结果，我们可以确定新代码和原有代码能否正确地集成在一起。

`持续交付CD（Continuous Delivery）`：gitlab cd。完成单元测试后，可以把代码部署到连接数据库的 Staging 环境中更多的测试。如果代码没有问题，可以继续手动部署到生产环境中。

`镜像仓库`：VMware Harbor，私服nexus。

`容器`：Docker。

`编排`：K8S。

`服务治理`：Consul。

`脚本语言`：Python。

`日志管理`：Cat+Sentry，还有种常用的是ELK。

`系统监控`：Prometheus。

`负载均衡`：Nginx。

`网关`：Kong，zuul。

`链路追踪`：Zipkin。

`产品和UI图`：蓝湖。

`公司内部文档`：Confluence。

`报警`：推送到工作群。

有了这一套完整的流程工具，整个开发流程涉及到人员都可以无阻碍的进行协调工作了，开发每天到公司，先看看jira,看看线上日志，出了问题看看监控日志，运营同学反馈问题不着急的去JIRA，着急的群里吆喝，产品和UI的图直接蓝湖看，运维关注监控着大盘，改革春风开满地，互联网人民真高兴~


**产品规划、开发编码、构建、QA测试、发布、部署和维护**



产品规划   提出需求，排期，需要整合资源，哪些模块

需求管理  项目管理  分支管理  环境管理（环境配置）

开发编码   如何构建  拉取代码 gitlab平台，调用API拉取代码



新建发布申请单

​        项目分支  环境  环境变量  构建yaml文件

​     

